---
title: YouTube 자동화 시스템 - 전체 아키텍처
---
flowchart TB
    subgraph ConfigLayer["⚙️ Config Layer (모든 것의 시작)"]
        ChannelConfig[(채널 Config<br/>주제, 소스, 업로드 설정)]
        PersonaConfig[(페르소나 Config<br/>말투, 관점, 음성)]
        FilterConfig[(필터 Config<br/>금지어, 민감 주제)]
        OperationConfig[(운영 Config<br/>자동화 단계, 검수)]
    end

    subgraph Collection["1️⃣ 주제 수집"]
        subgraph Sources["소스 (Config 기반 선택)"]
            Domestic[국내 커뮤니티<br/>디시, 클리앙, 루리웹...]
            Foreign[해외 소스<br/>Reddit, HN, Twitter...]
            News[뉴스/블로그<br/>RSS, API]
            Trends[트렌드<br/>Google, YouTube]
        end
        
        Collector[수집기<br/>스케줄 기반]
        Normalizer[정규화<br/>번역, 요약, 키워드]
        Dedup[중복 제거]
        TopicFilter[주제 필터<br/>include/exclude]
        Scorer[스코어링<br/>관련성, 트렌드]
        
        Sources --> Collector --> Normalizer --> Dedup --> TopicFilter --> Scorer
        Scorer --> TopicQueue[(주제 큐)]
    end

    subgraph PersonaRAG["2️⃣ 페르소나 RAG"]
        subgraph ContentDB["콘텐츠 DB"]
            PastContent[(과거 콘텐츠<br/>스크립트, 성과)]
            Chunker[청킹]
            Embedder[임베딩<br/>BGE-M3]
            VectorDB[(벡터 DB)]
            
            PastContent --> Chunker --> Embedder --> VectorDB
        end
        
        subgraph Retrieval["검색"]
            QueryExpand[쿼리 확장]
            HybridSearch[하이브리드 검색<br/>시맨틱 + BM25]
            Reranker[리랭커]
            
            QueryExpand --> HybridSearch --> Reranker
        end
        
        subgraph Generation["생성"]
            ContextBuilder[컨텍스트 빌더]
            PromptBuilder[프롬프트 빌더]
            LLM[LLM<br/>Claude API]
            PostProcess[후처리<br/>스타일 검증]
        end
        
        VectorDB --> HybridSearch
        Reranker --> ContextBuilder
        ContextBuilder --> PromptBuilder --> LLM --> PostProcess
    end

    subgraph ContentFilter["3️⃣ 콘텐츠 필터"]
        Filter1[1차: 키워드 필터<br/>빠른 차단]
        Filter2[2차: LLM 검토<br/>맥락 파악]
        RiskScore[리스크 스코어]
        
        Filter1 --> Filter2 --> RiskScore
    end

    subgraph VideoGen["4️⃣ 영상 생성"]
        TTS[TTS 엔진<br/>페르소나별 음성]
        VisualGen[비주얼 생성<br/>스톡/AI 이미지]
        SubtitleGen[자막 생성]
        Compositor[영상 합성<br/>FFmpeg]
        ThumbGen[썸네일 생성<br/>AI]
        
        TTS --> Compositor
        VisualGen --> Compositor
        SubtitleGen --> Compositor
    end

    subgraph Publishing["5️⃣ 퍼블리싱"]
        MetaGen[메타데이터 생성<br/>제목, 설명, 태그]
        TimeOptimizer[최적 시간 분석<br/>Analytics 기반]
        Scheduler[스케줄러]
        
        subgraph Platforms["플랫폼"]
            YouTube[YouTube API]
            TikTok[TikTok<br/>추후]
            Reels[Instagram<br/>추후]
        end
        
        MetaGen --> Scheduler
        TimeOptimizer --> Scheduler
        Scheduler --> Platforms
    end

    subgraph Review["6️⃣ 검수 시스템"]
        ReviewQueue[(검수 큐)]
        Dashboard[검수 대시보드]
        TelegramBot[텔레그램 알림]
        
        ReviewQueue --> Dashboard
        ReviewQueue --> TelegramBot
    end

    subgraph Analytics["7️⃣ 분석 & 피드백"]
        PerfCollector[성과 수집<br/>조회수, 시청시간]
        SeriesDetector[시리즈 감지<br/>연속 성공 분석]
        TimeAnalyzer[시간대 분석]
        FTDataset[(파인튜닝 데이터)]
        
        PerfCollector --> SeriesDetector
        PerfCollector --> TimeAnalyzer
        PerfCollector -->|고성과 스크립트| FTDataset
    end

    subgraph Community["8️⃣ 커뮤니티 관리"]
        CommentMonitor[댓글 모니터링]
        AutoLike[좋아요 자동화]
        BadCommentFilter[악플 필터/삭제]
    end

    %% 메인 플로우
    TopicQueue --> QueryExpand
    TopicQueue --> ContextBuilder
    
    PersonaConfig --> PromptBuilder
    PersonaConfig --> TTS
    
    PostProcess --> Filter1
    RiskScore -->|Safe| ScriptQueue[(스크립트 큐)]
    RiskScore -->|Review| ReviewQueue
    RiskScore -->|Block| BlockLog[(차단 로그)]
    
    ScriptQueue --> TTS
    ScriptQueue --> VisualGen
    ScriptQueue --> SubtitleGen
    
    Compositor --> VideoQueue[(영상 큐)]
    ThumbGen --> VideoQueue
    
    VideoQueue --> MetaGen
    
    YouTube --> PerfCollector
    PerfCollector --> TopicQueue
    TimeAnalyzer --> TimeOptimizer
    SeriesDetector -->|시리즈 제안| TopicQueue
    
    %% Config 연결
    ChannelConfig --> Collector
    ChannelConfig --> TopicFilter
    ChannelConfig --> Scorer
    FilterConfig --> Filter1
    FilterConfig --> Filter2
    OperationConfig --> ReviewQueue

    %% 검수 게이트
    OperationConfig -->|Phase 체크| Gate1{검수?}
    OperationConfig -->|Phase 체크| Gate2{검수?}
    OperationConfig -->|Phase 체크| Gate3{검수?}

    %% 스타일
    classDef config fill:#e8eaf6,stroke:#3f51b5
    classDef storage fill:#e3f2fd,stroke:#1565c0
    classDef process fill:#f3e5f5,stroke:#7b1fa2
    classDef ai fill:#fff3e0,stroke:#ef6c00
    classDef platform fill:#e8f5e9,stroke:#2e7d32
    
    class ChannelConfig,PersonaConfig,FilterConfig,OperationConfig config
    class TopicQueue,VectorDB,PastContent,ScriptQueue,VideoQueue,ReviewQueue,FTDataset,BlockLog storage
    class Collector,Normalizer,Dedup,Scorer,Chunker,ContextBuilder process
    class LLM,TTS,Embedder,Reranker,Filter2 ai
    class YouTube,TikTok,Reels platform
